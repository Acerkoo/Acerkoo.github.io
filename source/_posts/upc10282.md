---
title: The Erdös-Straus Conjecture（数学思维）
tags: 
- 数学
- 思维
categories:
- 数学
---

### 题目描述
The Brocard Erdös-Straus conjecture is that for any integer n > 2, there are positive integers a ≤ b ≤ c, so that: 
> (1)  4/n = 1/a + 1/b + 1/c 

There may be multiple solutions.  For example: 

> 4/18 = 1/9 + 1/10 + 1/90 = 1/5 + 1/90 + 1/90 = 1/5 + 1/46 + 1/2470 

Since it is still a conjecture, there are obviously no counterexamples for n ≤ 50,000.  For this problem, you will write a program which takes as input an integer n between 2 and 50000 inclusive and returns the smallest triple of integers a, b, c in lexicographic order which satisfies equation (1) above.  That is, if a1, b1, c1 is any other solution to (1) for the given input, then either (a < a1) or (a = a1 and b ≤ b1). 

### 输入
The first line of input contains a single decimal integer P, (1≤P≤1000), which is the number of data sets that follow.  Each data set should be processed identically and independently. 

Each data set consists of a single line of input.  It contains the data set number, K, followed by a single space, followed by the decimal integer n, (2≤n≤50000). 

### 输出
For each data set there is one line of output.  The single output line consists of the data set number, K, followed by a single space followed by the decimal integer values a, b and c in that order, separated by single spaces. 

### 样例输入
> 5
> 1 13
> 2 529
> 3 49849
> 4 49850
> 5 18
### 样例输出
> 1 4 18 468
> 2 133 23460 71764140 
> 3 12463 207089366 11696183113896622 
> 4 12463 310640276 96497380762715900 
> 5 5 46 2070

### 题意

给出 n（n<=50000), 求满足 4/n = 1/a + 1/b + 1/c  的 a, b, c， 若存在多个， 则输出 abc 字典序最小的那组。

### 思路

>    4/n = 1/a + 1/b + 1/c 
> => 4*a = (1 + a/b + a/c) * n
> => 4 * a - n = (a/b + a/c) * n
> => (4 * a - n)/ (a * n) = 1/b + 1/c 
>=> y/x = 1/b + 1/c
=> (y * b - b)/(x * b) = 1/c

通过公式推导可得：
    a > n/4 
    b > x/y
    当 (y * b  - b)|(x * b) 时， c = (x * b)/(y * b - b)

那么就可以通过枚举a， b 进行求解。

### 代码
```cpp
#include <bits/stdc++.h>
typedef long long ll;
using namespace std;
int _, k;

int main() {
    for (scanf("%d", &_); _; _--) {
        ll n;
        scanf("%lld", &n);
        ll a, b, c;
        bool fg = false;
        for (a = n / 4 + 1; a <= n / 2; ++a) {
            ll x = a * n, y = 1ll * 4 * a - n;
            ll gcd = __gcd(x, y);
            y /= gcd, x /= gcd;
            for (b = x / y + 1; b <= 2 * x / y; ++b) {
                if ((x * n) % (y * b - x) == 0) {
                    c = (x * b) / (y * b - x);
                    fg = 1;
                    break;
                }
            }
            if (fg) break;
        }
        printf("%d %lld %lld %lld\n", n, a, b, c);
    }
    return 0;
}
```